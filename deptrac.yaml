imports:
  - deptrac-baseline.yaml

deptrac:
  paths:
    - ./src
  layers:
    - name: Aggregate
      collectors:
        - type: directory
          value: src/Aggregate/.*
    - name: Attribute
      collectors:
        - type: directory
          value: src/Attribute/.*
    - name: Clock
      collectors:
        - type: directory
          value: src/Clock/.*
    - name: Console
      collectors:
        - type: directory
          value: src/Console/.*
    - name: EventBus
      collectors:
        - type: directory
          value: src/EventBus/.*
    - name: MetadataAggregate
      collectors:
        - type: directory
          value: src/Metadata/AggregateRoot/.*
    - name: MetadataEvent
      collectors:
        - type: directory
          value: src/Metadata/Event/.*
    - name: MetadataMessage
      collectors:
        - type: directory
          value: src/Metadata/Message/.*
    - name: MetadataProjector
      collectors:
        - type: directory
          value: src/Metadata/Projector/.*
    - name: Metadata
      collectors:
        - type: bool
          must:
            - type: directory
              value: src/Metadata/.*
          must_not:
            - type: layer
              value: MetadataAggregate
            - type: layer
              value: MetadataEvent
            - type: layer
              value: MetadataMessage
            - type: layer
              value: MetadataProjector
    - name: Pipeline
      collectors:
        - type: directory
          value: src/Pipeline/.*
    - name: Projection
      collectors:
        - type: directory
          value: src/Projection/.*
    - name: Repository
      collectors:
        - type: directory
          value: src/Repository/.*
    - name: Schema
      collectors:
        - type: directory
          value: src/Schema/.*
    - name: Serializer
      collectors:
        - type: directory
          value: src/Serializer/.*
    - name: Snapshot
      collectors:
        - type: directory
          value: src/Snapshot/.*
    - name: Store
      collectors:
        - type: directory
          value: src/Store/.*

  ruleset:
    Aggregate:
      - Attribute
      - MetadataAggregate
    Attribute:
    Clock:
    Console:
      - EventBus
      - MetadataAggregate
      - MetadataEvent
      - Outbox
      - Pipeline
      - Projection
      - Schema
      - Serializer
      - Store
      - WatchServer
    EventBus:
      - Aggregate
      - Attribute
      - MetadataMessage
      - Serializer
    Metadata:
    MetadataAggregate:
      - Aggregate
      - Attribute
      - Metadata
    MetadataEvent:
      - Attribute
      - Metadata
    MetadataMessage:
      - Attribute
      - Metadata
    MetadataProjector:
      - Attribute
      - Metadata
      - Projection
    Pipeline:
      - Aggregate
      - EventBus
      - Projection
      - Store
    Projection:
      - Attribute
      - Clock
      - MetadataProjector
      - EventBus
      - Schema
      - Store
    Repository:
      - Aggregate
      - Clock
      - MetadataAggregate
      - MetadataEvent
      - EventBus
      - Snapshot
      - Store
    Schema:
    Serializer:
      - Aggregate
      - MetadataEvent
    Snapshot:
      - Aggregate
      - MetadataAggregate
    Store:
      - Aggregate
      - Attribute
      - Metadata
      - EventBus
      - Schema
      - Serializer
